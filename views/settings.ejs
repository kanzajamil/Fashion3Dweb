<%- include('./partials/top-menu') %>
<div class="at-bannercontentholderr mb-0">
    <h1>Settings</h1>
</div>

<main id="at-main" class="at-main at-haslayout">
    <!--************************************
                Upload File Start
    *************************************-->
    <div class="at-haslayout at-sectionspace at-topspacezero">
        <div class="container">
            <div class="row">

<div class="at-settingsarea">
    <div class="settings-sections">
        <div class="form-group">
            <h3>Edit Profile</h3>
            <hr class="customm-hr">
        </div>
        
        <form class="at-formtheme at-loginform" action="" method="">
            
                
                <div class="form-group">
                    <label>Name</label>
                    <div class="at-inputwithicon">
                        <div class="form-control">
                            <%= user.name %>
                        </div>
                        <a class="icon-eye-splash" data-bs-toggle="modal" data-bs-target="#editModal" data-name="<%= user.name %>">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="tabler-icon tabler-icon-edit size-4"><path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"></path><path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"></path><path d="M16 5l3 3"></path></svg>
                        </a>
                        <!-- Modal -->
                        <!-- Modal Structure -->
                        <div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h3 class="modal-title" id="editModalLabel">Change Name</h3>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <form id="nameChangeForm">
                                            <div class="mb-3">
                                                <label for="userName" class="form-label">Please Enter your new Full Name</label>
                                                <input type="text" class="form-control" id="userName" name="name" placeholder="New Full Name" required>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="at-btn at-btnlogin" data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="at-btn at-btngradiant at-btnsignup" id="saveNameButton">Save</button> <!-- Changed to a normal button -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Email</label>
                    <div class="at-inputwithicon">
                        <div class="form-control">
                            <%= user.email %>
                        </div>
                        <a class="icon-eye-splash" data-bs-toggle="modal" data-bs-target="#editEmailModal">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="tabler-icon tabler-icon-edit size-4"><path d="M7 7h-1a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h9a2 2 0 0 0 2 -2v-1"></path><path d="M20.385 6.585a2.1 2.1 0 0 0 -2.97 -2.97l-8.415 8.385v3h3l8.385 -8.415z"></path><path d="M16 5l3 3"></path></svg>
                        </a>
                        <!-- Modal Structure for Email Change -->
                        <div class="modal fade" id="editEmailModal" tabindex="-1" aria-labelledby="editEmailModalLabel" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h3 class="modal-title" id="editEmailModalLabel">Change Email</h3>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                        <!-- OTP Verification Form -->
                                        <form id="otpVerificationForm">
                                            <div class="mb-3">
                                                <label for="otp" class="form-label">OTP has been sent to your current email. <br> <strong><%= user.email %></strong></label>
                                                <input type="text" class="form-control" name="otp" id="otp" placeholder="Enter OTP" required>
                                            </div>
                                        </form>
                                        
                                        <!-- New Email Entry Form (Initially Hidden) -->
                                        <form id="emailUpdateForm" style="display: none;">
                                            <div class="mb-3">
                                                <label for="newEmail" class="form-label">Enter New Email Address</label>
                                                <input type="email" class="form-control" id="newEmail" name="newEmail" placeholder="New Email Address" required>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="at-btn at-btnlogin" data-bs-dismiss="modal">Cancel</button>
                                        <button type="button" class="at-btn at-btngradiant at-btnsignup" id="verifyOtpButton">Verify</button>
                                        <button type="button" class="at-btn at-btngradiant at-btnsignup" id="saveEmailButton" style="display: none;">Save</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Date Created</label>
                    <div class="at-inputwithicon">
                        <input type="password" name="password" class="form-control" placeholder="<%=user.createdAt %>" autocomplete="off" readonly>
                        
                    </div>
                </div>
                
                
            </fieldset>
        </form>
    </div>
    <div class="password-section">
        <div class="form-group">
            <h3>Change Password</h3>
            <hr class="customm-hr">
        </div>
        <div class="delete-content">
            <p>You can change your password here to ensure your account remains secure. </p>
            <a type="button" class="at-btn at-btnnlogin" data-bs-toggle="modal" data-bs-target="#editPasswordModal">Change Password</a>

            <div class="modal fade" id="editPasswordModal" tabindex="-1" aria-labelledby="editPasswordModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title" id="editPasswordModalLabel">Change Password</h3>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <!-- OTP Verification Form -->
                            <form id="passwordverifyForm">
                                <div class="mb-3">
                                    <label for="otp" class="form-label">To set up a new password, please enter your current password first.</label>
                                    <div class="at-inputwithicon">
                                    <input type="password" class="form-control" name="pass" id="pass" placeholder="Enter Current Password" required>
                                    <i class="icon-eye-splash" id="togglePasswordVisible">
                                        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M11.6854 9C11.6854 10.485 10.4854 11.685 9.00043 11.685C7.51543 11.685 6.31543 10.485 6.31543 9C6.31543 7.515 7.51543 6.315 9.00043 6.315C10.4854 6.315 11.6854 7.515 11.6854 9Z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M8.99988 15.2025C11.6474 15.2025 14.1149 13.6425 15.8324 10.9425C16.5074 9.885 16.5074 8.1075 15.8324 7.05C14.1149 4.35 11.6474 2.79 8.99988 2.79C6.35238 2.79 3.88488 4.35 2.16738 7.05C1.49238 8.1075 1.49238 9.885 2.16738 10.9425C3.88488 13.6425 6.35238 15.2025 8.99988 15.2025Z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </i>
                                    <i class="icon-eye-hidden" id="togglePasswordHidden" style="display:none;">
                                        <svg class="w-6 h-6 text-white-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24">
                                            <path stroke="#ccc" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.933 13.909A4.357 4.357 0 0 1 3 12c0-1 4-6 9-6m7.6 3.8A5.068 5.068 0 0 1 21 12c0 1-3 6-9 6-.314 0-.62-.014-.918-.04M5 19 19 5m-4 7a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/>
                                        </svg>
                                    </i>
                                    </div>
                                </div>
                                <a href="/forgot-password" target="_self">Forgot Password?</a>
                            </form>
                            
                            <!-- New Email Entry Form (Initially Hidden) -->
                            <form id="passwordUpdateForm" style="display: none;">
                                <div class="mb-3">
                                    <label for="newPassword" class="form-label">Enter New Password</label>
                                    <div class="at-inputwithicon">
                                        <input type="password" class="form-control" id="newPassword" name="newPassword" placeholder="New Password" required>
                                        <i class="icon-eye-splash" id="toggPasswordVisible">
                                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M11.6854 9C11.6854 10.485 10.4854 11.685 9.00043 11.685C7.51543 11.685 6.31543 10.485 6.31543 9C6.31543 7.515 7.51543 6.315 9.00043 6.315C10.4854 6.315 11.6854 7.515 11.6854 9Z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M8.99988 15.2025C11.6474 15.2025 14.1149 13.6425 15.8324 10.9425C16.5074 9.885 16.5074 8.1075 15.8324 7.05C14.1149 4.35 11.6474 2.79 8.99988 2.79C6.35238 2.79 3.88488 4.35 2.16738 7.05C1.49238 8.1075 1.49238 9.885 2.16738 10.9425C3.88488 13.6425 6.35238 15.2025 8.99988 15.2025Z" stroke="white" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                        </i>
                                        <i class="icon-eye-hidden" id="toggPasswordHidden" style="display:none;">
                                            <svg class="w-6 h-6 text-white-800 dark:text-white" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" viewBox="0 0 24 24">
                                                <path stroke="#ccc" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.933 13.909A4.357 4.357 0 0 1 3 12c0-1 4-6 9-6m7.6 3.8A5.068 5.068 0 0 1 21 12c0 1-3 6-9 6-.314 0-.62-.014-.918-.04M5 19 19 5m-4 7a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/>
                                            </svg>
                                        </i>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="at-btn at-btnlogin" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="at-btn at-btngradiant at-btnsignup" id="verifyPassButton">Continue</button>
                            <button type="button" class="at-btn at-btngradiant at-btnsignup" id="savePassButton" style="display: none;">Save</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="delete-sections">
        <div class="form-group">
            <h3>Delete Account</h3>
            <hr class="customm-hr">
        </div>
        <div class="delete-content">
            <p>Deleting your account will permanently remove all of your assets and cannot be undone.</p>
            <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteAccountModal">Delete Account</button>

            <div class="modal fade" id="deleteAccountModal" tabindex="-1" aria-labelledby="deleteAccountModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h3 class="modal-title" id="deleteAccountModalLabel">Delete Account</h3>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <p>This action cannot be undone. You will loose your all data. Are you sure you want to delete this account? </p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <button type="button" class="btn btn-danger" id="confirmDeleteButton">Yes, Delete my account.</button>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>

</div>
</div>
</div>
</div>
<script>
    document.getElementById("togglePasswordVisible").addEventListener("click", function() {
        var passwordField = document.getElementById("pass");
        var visibleIcon = document.getElementById("togglePasswordVisible");
        var hiddenIcon = document.getElementById("togglePasswordHidden");
        
        if (passwordField.type === "password") {
            passwordField.type = "text"; // Show the password
            visibleIcon.style.display = "none"; // Hide the "visible" icon
            hiddenIcon.style.display = "block"; // Show the "hidden" icon
        } else {
            passwordField.type = "password"; // Hide the password
            visibleIcon.style.display = "block"; // Show the "visible" icon
            hiddenIcon.style.display = "none"; // Hide the "hidden" icon
        }
    });

    document.getElementById("togglePasswordHidden").addEventListener("click", function() {
        var passwordField = document.getElementById("pass");
        var visibleIcon = document.getElementById("togglePasswordVisible");
        var hiddenIcon = document.getElementById("togglePasswordHidden");
        
        if (passwordField.type === "password") {
            passwordField.type = "text"; // Show the password
            visibleIcon.style.display = "none"; // Hide the "visible" icon
            hiddenIcon.style.display = "block"; // Show the "hidden" icon
        } else {
            passwordField.type = "password"; // Hide the password
            visibleIcon.style.display = "block"; // Show the "visible" icon
            hiddenIcon.style.display = "none"; // Hide the "hidden" icon
        }
    });


</script>

<script>
    document.getElementById("toggPasswordVisible").addEventListener("click", function() {
        var passwordField2 = document.getElementById("newPassword");
        var visibleIcon = document.getElementById("toggPasswordVisible");
        var hiddenIcon = document.getElementById("toggPasswordHidden");
        
        if (passwordField2.type === "password") {
            passwordField2.type = "text"; // Show the password
            visibleIcon.style.display = "none"; // Hide the "visible" icon
            hiddenIcon.style.display = "block"; // Show the "hidden" icon
        } else {
            passwordField2.type = "password"; // Hide the password
            visibleIcon.style.display = "block"; // Show the "visible" icon
            hiddenIcon.style.display = "none"; // Hide the "hidden" icon
        }
    });

    document.getElementById("toggPasswordHidden").addEventListener("click", function() {
        var passwordField2 = document.getElementById("newPassword");
        var visibleIcon = document.getElementById("toggPasswordVisible");
        var hiddenIcon = document.getElementById("toggPasswordHidden");
        
        if (passwordField2.type === "password") {
            passwordField2.type = "text"; // Show the password
            visibleIcon.style.display = "none"; // Hide the "visible" icon
            hiddenIcon.style.display = "block"; // Show the "hidden" icon
        } else {
            passwordField2.type = "password"; // Hide the password
            visibleIcon.style.display = "block"; // Show the "visible" icon
            hiddenIcon.style.display = "none"; // Hide the "hidden" icon
        }
    });


</script>


</main>
<%- include('./partials/footer') %>
